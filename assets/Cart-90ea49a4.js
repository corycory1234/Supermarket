import{_ as z,a as Q,I as R,r as d,e as I,f as i,g as r,i as t,j as n,k as q,x as e,F,y as X,v as x,E as _,z as D,A as N,B as T,q as Y,l as O,H as S,s as G,t as J}from"./index-eb4185d7.js";import{u as W}from"./cartStore-aa0a97ba.js";import{u as Z}from"./filter-2e5f3b44.js";import{F as tt}from"./Footer-c65a8fbb.js";import{C as et}from"./CheckoutStep-37e04fc0.js";const s=g=>(G("data-v-f1d49d61"),g=g(),J(),g),st={class:"container-fluid page-header py-5 mb-5 wow fadeIn","data-wow-delay":"0.1s"},ot={class:"container text-center py-5"},lt=s(()=>t("h1",{class:"display-3 text-white mb-4 animated slideInDown"},"CHECK OUT",-1)),at={"aria-label":"breadcrumb animated slideInDown"},nt={class:"breadcrumb justify-content-center mb-0"},ct={class:"breadcrumb-item"},dt={class:"breadcrumb-item active","aria-current":"page"},it={class:"step-container"},rt={key:0,class:"wrapper container"},ut={class:"row"},_t={class:"col-xl-7 col-md-12 mt-5"},pt={class:"table align-middle"},mt=s(()=>t("thead",null,[t("tr",null,[t("th",{style:{width:"150px"}},"PIC"),t("th",{class:"title-wrapper"},"Name"),t("th",{style:{width:"110px"},class:"text-center",id:"qty-wrapper"},"QTY"),t("th",{class:"text-center price-wrapper"},"$"),t("th",{style:{width:"50px"},class:"i-wrapper"})])],-1)),ht={class:"img-wrapper"},vt=["src"],ft={class:"input-group input-group-sm"},bt=["onUpdate:modelValue","onChange","disabled"],xt={class:"text-center"},gt=["disabled","onClick"],yt=s(()=>t("i",{class:"bi bi-x-square-fill"},null,-1)),Ct=[yt],kt={class:"col-xl-5 col-md-12 mt-5"},wt={class:"table align-middle"},Vt=s(()=>t("tr",null,[t("th",{colspan:"3"},"Detail"),t("td")],-1)),It=s(()=>t("th",{colspan:"3",class:"text-start"},"Original Price",-1)),St={class:"text-end"},Et={key:0},Ut=s(()=>t("th",{colspan:"3",class:"text-start text-success"},"Discounts",-1)),qt={class:"text-end text-success"},Dt={key:1},Nt=s(()=>t("th",{colspan:"3"},"Total",-1)),Tt={class:"text-end"},$t={key:2},At=s(()=>t("th",{colspan:"3"},"After Discount",-1)),Ft={class:"text-end"},Ot={class:"input-group mb-3 input-group-sm"},Mt={key:1,class:"d-flex wrapper2"},Pt={class:"mt-5 col-lg-8 col-md-8 form-wrapper"},Bt={class:"mb-3"},Ht=s(()=>t("label",{for:"email",class:"form-label"},"Email",-1)),jt={class:"mb-3"},Kt=s(()=>t("label",{for:"name",class:"form-label"},"Name",-1)),Lt={class:"mb-3"},zt=s(()=>t("label",{for:"tel",class:"form-label"},"Phone",-1)),Qt={class:"mb-3"},Rt=s(()=>t("label",{for:"address",class:"form-label"},"Address",-1)),Xt={class:"mb-3"},Yt=s(()=>t("label",{for:"message",class:"form-label"},"Message",-1)),Gt=s(()=>t("button",{class:"button"},"SEND",-1)),Jt={class:"col-lg-2 col-md-4 col-sm-12 mt-5 justify-content-center order-detail"},Wt={class:"table align-middle"},Zt=s(()=>t("tr",null,[t("th",{colspan:"3"},"DETAIL"),t("td")],-1)),te=s(()=>t("th",{colspan:"3",class:"text-start"},"Original Price ",-1)),ee={class:"text-end"},se={key:0},oe=s(()=>t("th",{colspan:"3",class:"text-start text-success"},"Discount",-1)),le={class:"text-end text-success"},ae={key:1},ne=s(()=>t("th",{colspan:"3"},"Total",-1)),ce={class:"text-end"},de={key:2},ie=s(()=>t("th",{colspan:"3"},"After Discount",-1)),re={class:"text-end"},ue={__name:"Cart",setup(g){Q(()=>{E()});const $=W(),{cart:v,idArr:_e,total:f,final_total:b}=R($),{getCart:E,removeCartItem:M}=$;console.log(b);const y=d({loadingItem:null}),P=p=>{const o=`https://vue3-course-api.hexschool.io/api/cookiemidwang-api/cart/${p.id}`;A.value=!0,y.value.loadingItem=p.id;const u=d({product_id:p.product_id,qty:p.qty});T.put(o,{data:u.value}).then(m=>{console.log(m),A.value=!1,y.value.loadingItem=null,E()})},U=d(""),C=d(null),B=()=>{const p="https://vue3-course-api.hexschool.io/api/cookiemidwang-api/coupon",o=d({code:U.value});T.post(p,{data:o.value}).then(u=>{C.value=u.data.data.final_total,console.log(C.value),E()})},k=d(!1),H=()=>{k.value=!0,w.value.nextStep()},j=()=>{k.value=!1,w.value.preStep()},c=d({user:{name:null,email:null,tel:null,address:null},message:null}),K=()=>{const p="https://vue3-course-api.hexschool.io/api/cookiemidwang-api/order",o=d(c.value);T.post(p,{data:o.value}).then(u=>{if(w.value.nextStep(),console.log(u),u.data.success){const m=d("");m.value=u.data.orderId,Y.push(`/user/checkout/${m.value}`)}})},A=d(!1),h=Z(),w=d(null);return(p,o)=>{const u=I("router-link"),m=I("Field"),V=I("ErrorMessage"),L=I("Form");return i(),r(F,null,[t("div",st,[t("div",ot,[lt,t("nav",at,[t("ol",nt,[t("li",ct,[n(u,{to:{name:"home"},class:"item"},{default:q(()=>[O("HOME")]),_:1})]),t("li",dt,[n(u,{to:"/user/Cart2",class:"item"},{default:q(()=>[O("CHECK OUT")]),_:1})])])])])]),t("div",it,[n(et,{ref_key:"refStep",ref:w},null,512)]),k.value?x("",!0):(i(),r("div",rt,[t("div",ut,[t("div",_t,[t("table",pt,[mt,t("tbody",null,[e(v).carts?(i(!0),r(F,{key:0},X(e(v).carts,l=>(i(),r("tr",{key:l.id},[t("td",ht,[t("img",{src:l.product.imageUrl,class:"img-fluid",alt:"",style:{width:"100%"}},null,8,vt)]),t("td",null,_(l.product.title),1),t("td",null,[t("div",ft,[D(t("input",{type:"number",class:"form-control","onUpdate:modelValue":a=>l.qty=a,min:"1",onChange:a=>P(l),disabled:l.id===y.value.loadingItem},null,40,bt),[[N,l.qty,void 0,{number:!0}]])])]),t("td",xt,_(e(h).currency(l.total)),1),t("td",null,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",disabled:y.value.loadingItem===l.id,onClick:a=>e(M)(l.id)},Ct,8,gt)])]))),128)):x("",!0)])])]),t("div",kt,[t("table",wt,[t("tfoot",null,[Vt,t("tr",null,[It,t("td",St,_(e(h).currency(e(v).total)),1)]),e(v).final_total!==e(v).total?(i(),r("tr",Et,[Ut,t("td",qt,_(e(h).currency(e(v).final_total)),1)])):x("",!0),C.value?(i(),r("tr",$t,[At,t("td",Ft,_(e(h).currency(e(f)-e(b))),1)])):(i(),r("tr",Dt,[Nt,t("td",Tt,_(e(f)),1)]))])]),t("div",Ot,[D(t("input",{type:"text",class:"form-control","onUpdate:modelValue":o[0]||(o[0]=l=>U.value=l),placeholder:"Type Coupon Code"},null,512),[[N,U.value]]),t("div",{class:"input-group-append"},[t("button",{class:"btn btn-outline-secondary",type:"button",onClick:B}," USE COUPON "),t("button",{class:"button",onClick:H},"NEXT")])])])])])),k.value?(i(),r("div",Mt,[t("div",Pt,[n(L,{class:"col-lg-8 col-md-8 col-sm-12",onSubmit:K},{default:q(({errors:l})=>[t("div",Bt,[Ht,n(m,{id:"email",name:"email",type:"email",class:S(["form-control input",{"is-invalid":l.email}]),placeholder:"Email",rules:"email|required",modelValue:c.value.user.email,"onUpdate:modelValue":o[1]||(o[1]=a=>c.value.user.email=a)},null,8,["class","modelValue"]),n(V,{name:"email",class:"invalid-feedback"})]),t("div",jt,[Kt,n(m,{id:"name",name:"姓名",type:"text",class:S(["form-control input",{"is-invalid":l.姓名}]),placeholder:"Name",rules:"required",modelValue:c.value.user.name,"onUpdate:modelValue":o[2]||(o[2]=a=>c.value.user.name=a)},null,8,["class","modelValue"]),n(V,{name:"姓名",class:"invalid-feedback"})]),t("div",Lt,[zt,n(m,{id:"tel",name:"電話",type:"tel",class:S(["form-control input",{"is-invalid":l.電話}]),placeholder:"Phone",rules:"required",modelValue:c.value.user.tel,"onUpdate:modelValue":o[3]||(o[3]=a=>c.value.user.tel=a)},null,8,["class","modelValue"]),n(V,{name:"電話",class:"invalid-feedback"})]),t("div",Qt,[Rt,n(m,{id:"address",name:"地址",type:"text",class:S(["form-control input",{"is-invalid":l.地址}]),placeholder:"Address",rules:"required",modelValue:c.value.user.address,"onUpdate:modelValue":o[4]||(o[4]=a=>c.value.user.address=a)},null,8,["class","modelValue"]),n(V,{name:"地址",class:"invalid-feedback"})]),t("div",Xt,[Yt,D(t("textarea",{name:"",id:"message",class:"form-control input",cols:"30",rows:"10","onUpdate:modelValue":o[5]||(o[5]=a=>c.value.message=a)},null,512),[[N,c.value.message]])]),t("div",{class:"form-btn-container"},[t("button",{class:"text-start button",onClick:j},"BACK"),Gt])]),_:1})]),t("div",Jt,[t("table",Wt,[t("tfoot",null,[Zt,t("tr",null,[te,t("td",ee,_(e(h).currency(e(f))),1)]),e(b)!==e(f)?(i(),r("tr",se,[oe,t("td",le,_(e(h).currency(e(b))),1)])):x("",!0),C.value?(i(),r("tr",de,[ie,t("td",re,_(e(h).currency(e(f)-e(b))),1)])):(i(),r("tr",ae,[ne,t("td",ce,_(e(f)),1)]))])])])])):x("",!0),n(tt)],64)}}},be=z(ue,[["__scopeId","data-v-f1d49d61"]]);export{be as default};
